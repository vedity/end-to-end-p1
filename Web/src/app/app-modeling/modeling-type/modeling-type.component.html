<div class="container-fluid w3-animate-right">
    <!-- start page title -->
    <div class="row">
        <div class="col-12">
            <div class="page-title-box d-flex align-items-center justify-content-between">
                <h4 class="mb-0 font-size-18">Modeling</h4>
                <a href="javascript:void(0);" [routerLink]="['/schema']" [state]="{activeId:5,navigate_to:'modeling'}" title="back" class="back-btn">Back</a>
                <div class="page-title-right">

                    <!-- <div class="tab-menu">

                        <ul ngbNav #justifiednav="ngbNav" [activeId]="1" class="nav-tabs nav-tabs-custom nav-justified nav">
                            <li [ngbNavItem]="1">
                                <a ngbNavLink>
                                    <span class="d-block d-sm-none"><i class="fas fa-home"></i></span>
                                    <span class="d-none d-sm-block">Modelling</span>
                                </a>
                                <ng-template ngbNavContent>
                                   

                                </ng-template>
                            </li>
                            <li [ngbNavItem]="2">
                                <a ngbNavLink>
                                    <span class="d-block d-sm-none"><i class="far fa-user"></i></span>
                                    <span class="d-none d-sm-block">Experiment List</span>
                                </a>
                                <ng-template ngbNavContent>
                                    <h4>One111</h4>
                                </ng-template>
                            </li>

                        </ul>

                    </div> -->
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="card start-box ">
                <div class="card-body">
                    <div class="left-box ">
                        <div class="loader {{processclass}}">Loading...</div>
                        <button type="submit" class="btn btn-success" *ngIf="processclass=='stop'" (click)="smallModal(modelingmodal)">Start</button>
                        <button type="submit" class="btn btn-success" *ngIf="processclass=='start'" (click)="processclass='stop'">Stop</button>
                    </div>
                    <div class="right-box">
                        <h4 class="card-title mt-4 mb-3">Modeling Mode</h4>
                        <div class="box">
                            <span class="switcher switcher-1">
                                <input type="checkbox" id="switcher-1"
                                    (click)="LargeModal(largeModal,$event.target.checked)">
                                <label for="switcher-1"></label>
                            </span>

                        </div>

                    </div>

                </div>
            </div>
        </div>

        <div class="col-md-4 ">
            <div class="card project-detail">
                <div class="card-body" *ngIf="datasetdata">
                    <div class="left">
                        <div class="line">
                            <label>Project</label>
                            <p>{{datasetdata.project_name}} </p>
                        </div>
                        <div class="line">
                            <label>Target Column</label>
                            <p class="target_column" *ngFor="let item of datasetdata.target_columns">{{item}}
                            </p>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card project-detail">
                <div class="card-body">
                    <h4 class="card-title">Experiment Detail </h4>
                    <p class="mb-0">{{experiment_name}}</p>
                    <p class="mb-0">{{experiment_desc}}</p>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-md-12 model-detail-main">
            <h4 class="mb-4">Experiment List</h4>
            <ngx-skeleton-loader [hidden]="contentloaded" count="7" [animation]="animation" [theme]="theme">
            </ngx-skeleton-loader>

            <button type="button" [disabled]="!iscompare" class="btn btn-success comper-btn">Comparison</button>

            <div class="right-detail-box">
                <span class="switcher switcher-1">
                    <input type="checkbox" id="switcher-1" value="true">
                    <label for="switcher-1"></label>
                </span>

            </div>


            <ul ngbNav #justifiednavnew="ngbNav" [activeId]="1" class="nav-pills nav-justified">
                <li [ngbNavItem]="1">
                    <a ngbNavLink>
                        <span class="d-block"><i class="fas fa-border-all"></i></span>

                    </a>
                    <ng-template ngbNavContent>
                        <!-- <perfect-scrollbar style="height: 490px;"> -->
                        <div class="row">
                            <div class="col-md-4" *ngFor="let item of modeldata;let i=index">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title mb-4">
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" (change)="setCopmareIds($event.target.checked,item.experiment_id)" id="customCheck_{{i}}">
                                                <label class="custom-control-label" for="customCheck_{{i}}">{{item.experiment_name}}</label>
                                            </div> <span class="date-time">{{item.exp_created_on | date}}</span>
                                        </h4>
                                        <div class="model-status">
                                            <i *ngIf="item.status=='running'" title="{{item.status}}" style="color: #34c38f;" class="dripicons-browser-upload Blink"></i>
                                            <i *ngIf="item.status=='error'" title="{{item.status}}" style="color: #f14646;" class="dripicons-browser-upload"></i>
                                            <i *ngIf="item.status=='pending'" title="{{item.status}}" style="color: #a6b0cf;" class="dripicons-browser-upload"></i>
                                            <i *ngIf="item.status=='completed'" title="{{item.status}}" style="color: #3e6aec;" class="dripicons-browser-upload"></i>

                                        </div>

                                        <div class="model-type">
                                            <p>{{item.model_mode}}</p>
                                        </div>

                                        <div class="detail-line">
                                            <label>Model</label>
                                            <p>{{item.model_name}}</p>
                                        </div>

                                        <div class="detail-line">
                                            <label>Dataset</label>
                                            <p>{{item.dataset_name}}</p>
                                        </div>
                                        <div class="detail-line small-line">
                                            <label>Holdout</label>
                                            <p>{{item.holdout_score}}</p>
                                        </div>

                                        <div class="detail-line small-line">
                                            <label>Cross Validation</label>
                                            <p>{{item.cv_score}}</p>
                                        </div>

                                        <div class="text-right">
                                            <button class="btn btn-outline-success" (click)="extraLarge(exlargeModal,item.experiment_name)">View
                                                Detail </button>


                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- </perfect-scrollbar> -->
                    </ng-template>
                </li>
                <li [ngbNavItem]="2">
                    <a ngbNavLink>
                        <span class="d-block "><i class="fas fa-bars"></i></span>

                    </a>
                    <ng-template ngbNavContent>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card list-view">
                                    <div class="card-body">
                                        <table datatable [dtOptions]="dtOptions" class="table table-centered">
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th>Experiment</th>
                                                    <th class="model_desc">Model</th>
                                                    <th>Dataset</th>
                                                    <th>Modeling Type</th>
                                                    <th>Status</th>
                                                    <th>Cross Validation</th>
                                                    <th>Holdout</th>
                                                    <th>Start Date</th>
                                                    <!-- <th>Detail</th> -->
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let item of modeldata;let i=index" id="tr_{{item.experiment_id}}">
                                                    <td>
                                                        <div class="custom-control custom-checkbox mb-3">
                                                            <input type="checkbox" class="custom-control-input" name="isprivate" id="customCheck_{{i}}">
                                                            <label class="custom-control-label" for="customCheck_{{i}}"></label>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <a href="javascript:void(0);" title="View Detail" (click)="extraLarge(exlargeModal,item.experiment_name)">{{item.experiment_name}}</a>
                                                    </td>
                                                    <td class="model_desc">
                                                        <p>{{item.model_name}}</p>
                                                        <!-- <p class="discription">{{item.model_desc}} </p> -->
                                                    </td>
                                                    <td>{{item.dataset_name}}</td>
                                                    <td>{{item.model_mode}}</td>
                                                    <td>
                                                        <i *ngIf="item.status=='running'" title="{{item.status}}" style="color: #34c38f;" class="dripicons-browser-upload Blink"></i>
                                                        <i *ngIf="item.status=='error'" title="{{item.status}}" style="color: #f14646;" class="dripicons-browser-upload"></i>
                                                        <i *ngIf="item.status=='pending'" title="{{item.status}}" style="color: #a6b0cf;" class="dripicons-browser-upload"></i>
                                                        <i *ngIf="item.status=='completed'" title="{{item.status}}" style="color: #3e6aec;" class="dripicons-browser-upload"></i>


                                                    </td>
                                                    <td>{{item.cv_score}}</td>
                                                    <td>{{item.holdout_score}}</td>
                                                    <td>{{item.exp_created_on | date}}</td>
                                                    <!-- <td><a href="javascript:void(0);" title="View Detail" (click)="extraLarge(exlargeModal)">View
                                                            Detail</a></td> -->
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </ng-template>
                </li>

            </ul>
            <div [ngbNavOutlet]="justifiednavnew" [hidden]="!contentloaded"></div>
        </div>
    </div>
    <button class="btn btn-outline-success openmodal" hidden (click)="ProjectData(projectModal)">View
        Detail </button>
    <!-- <div [ngbNavOutlet]="justifiednav">

    </div> -->
</div>



<ng-template #exlargeModal let-modal class="model-detail">
    <div class="modal-header">
        <h5> {{modeltitle}}</h5>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body statistics">
        <app-modeling-view-detail></app-modeling-view-detail>
    </div>
</ng-template>


<ng-template #modelingmodal let-modal class="modeling-modal">
    <div class="modal-header">
        <h5 class="modal-title mt-0">Create Experiment</h5>
        <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-hidden="true">×</button>
    </div>
    <div class="modal-body">
        <form #f="ngForm">

            <div class="form-group">
                <label for="example-text-input" class="col-form-label">Experiment Name<span
                        class="required-label">&nbsp;*</span></label>

                <input class="form-control" required type="text" [(ngModel)]="params.experiment_name" name="experiment_name" #experiment_name="ngModel" maxlength="200">
                <div class="invalid-feedback" *ngIf="experiment_name.errors?.required && (experiment_name.dirty || experiment_name.touched)">
                    <span *ngIf="experiment_name.errors?.required && (experiment_name.dirty || experiment_name.touched)" class="text-red">Please enter experiment name</span>
                </div>
            </div>
            <div class="form-group">
                <label for="example-text-input" class="col-form-label">Experiment Description<span
                        class="required-label">&nbsp;*</span></label>
                <textarea class="form-control" maxlength="500" [(ngModel)]="params.experiment_desc" name="experiment_desc" #experiment_desc="ngModel" required></textarea>
                <div class="invalid-feedback" *ngIf="experiment_desc.errors?.required && (experiment_desc.dirty || experiment_desc.touched)">
                    <span *ngIf="experiment_desc.errors?.required && (experiment_desc.dirty || experiment_desc.touched)" class="text-red">Please enter description</span>
                </div>
            </div>

            <div class="button-items text-center">
                <button class="btn btn-success" [disabled]="!f.form.valid" (click)="startModel()" (click)="modal.dismiss('Cross click')">Start</button>
            </div>
        </form>
    </div>
</ng-template>


<ng-template #largeModal let-modal>
    <div class="modal-header">
        <h5> Manual Modeling </h5>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body manul-modeling">
        <div class="row content-1" *ngIf="contentid==1">
            <div class="col-md-12">
                <h4 class="font-size-18 mt-3 mb-3">Split Dataset</h4>
                <div class="form-group">
                    <label>Select split method</label>
                    <select class="form-control" (change)="splitmethodselection=$event.target.value">
                        <option value="crossvalidation">Cross Validation</option>
                        <option value="trainvalidation">Train - Validation - Holdout</option>
                    </select>
                </div>
                <div class="cross-validation" *ngIf="splitmethodselection=='crossvalidation'">
                    <div class="form-group">
                        <label>Number of cross validation(CV) folds</label>
                        <input type="text" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Holdout perecentage</label>
                        <input type="range" class="custom-range" min="0" max="100" id="customRange2">
                        <!-- <div class="range-wrap">
            <input type="range" class="range">
            <output class="bubble" value="50"></output>
          </div> -->
                    </div>
                    <div class="from-group">
                        <label>Random status</label>
                        <input type="number" class="form-control">
                    </div>
                </div>
                <div class="tr-v-h" *ngIf="splitmethodselection=='trainvalidation'">
                    <div class="form-group">
                        <label>Split ratio</label>
                        <select class="form-control">
                            <option>60% - 20% - 20%</option>
                            <option>70% - 15% - 15%</option>
                            <option>80% - 10% - 10%</option>
                            <option>90% - 5% - 5%</option>
                            <option>95% - 5% - 0%</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Random status</label>
                        <input type="number" class="form-control">
                    </div>
                </div>
                <div class="text-center mb-4 mt-3">
                    <button class="btn btn-success" type="submit" (click)="showContent(2)">Next</button>
                </div>
            </div>
        </div>
        <div class="row content-2" *ngIf="contentid==2">
            <div class="col-md-12">
                <h4 class="font-size-18 mt-3 mb-3">Select model</h4>
            </div>
            <div class="col-md-12">
                <div class="form-group">
                    <label>Select model</label>
                    <!-- <select class="form-control" (change)="hyperparams=$event.target.value">
                        <option value="sklearn">Linear Regression with SK Learn</option>
                        <option value="keras">Linear Regression with Keras</option>
                    </select> -->
                    <select class="form-control" (change)="getHyperParams($event.target.value)">
                        <option value=""> Select </option>
                        <option value="{{item}}" *ngFor="let item of algorithmlist">{{item}}</option>
                    </select>

                </div>
            </div>
            <div class="col-md-12" *ngIf="paramsList!=null">
                <h4 class="font-size-18 mt-3 mb-3">Hyperparameter</h4>
            </div>

            <div class="col-md-6" *ngFor="let item of paramsList">
                <div class="form-group">
                    <label>{{item}}</label>
                    <input type="text" class="form-control">
                </div>
            </div>

            <div class="col-md-12">
                <div class="text-center mb-4">
                    <button class="btn btn-success mr-3" type="submit" (click)="showContent(1)">Previous</button>
                    <button class="btn btn-success" type="submit" (click)="modal.dismiss('Cross click')">Save</button>
                </div>
            </div>
        </div>
    </div>
</ng-template>


<ng-template #projectModal let-modal>
    <div class="modal-header">
        <h5> Project Detail </h5>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <label>Select Project</label>
                    <select class="form-control" (change)="hyperparams=$event.target.value">
                    <option value="sklearn">Project 1</option>
                    <option value="keras">Project 2</option>
                </select>
                </div>
            </div>
            <div class="col-md-12">
                <div class="form-group">
                    <label>Select Dataset</label>
                    <select class="form-control" (change)="hyperparams=$event.target.value">
                    <option value="sklearn">Dataset 1</option>
                    <option value="keras">Dataset 2</option>
                </select>
                </div>
            </div>
            <div class="col-md-12">
                <div class="text-center mb-4">
                    <button class="btn btn-success" type="submit" (click)="modal.dismiss('Cross click')">Next</button>
                </div>
            </div>
        </div>
    </div>
</ng-template>